sudo pip install virtualenv
virtualenv -p python3 beam-venv
source venv/bin/activate
pip install apache-beam[gcp]
pip install python-snappy

##Building Docker image using cloud build and pushing into GCR
export TEMPLATE_IMAGE="gcr.io/<PROJECT>/<IMAGE_NAME>:<TAG>"
gcloud builds submit --tag <TEMPLATE_IMAGE> .

##Creating Flex template
export TEMPLATE_PATH="gs://<BUCKET_NAME>/<PATH>/<FILENAME>"
gcloud dataflow flex-template build <TEMPLATE_PATH> \
--image "<TEMPLATE_IMAGE>" \
--sdk-language "PYTHON" \
--metadata-file "<METADATA_FILE_PATH>"
